   WEEKLY INVITE, SEE ANIMA BOOTSTRAP WIKI:
   [1]https://trac.tools.ietf.org/wg/anima/trac/wiki/Bootstrap  draft is
   always at:
   [2]https://tools.ietf.org/html/draft-ietf-anima-bootstrapping-keyinfra-
   04
   NOTE NOTE NOTE: BRSKIEtherpad
   Current and most recent meeting notes are added to the BOTTOM of this
   document.
   The reason for this is so that we can consistently refer to line number
   and have them stay (mostly) the same as we add newlines. If Etherpad
   offered a feature for numbering from the bottom we could dispense with
   the pain of scrolling to the bottom of the document but:

       PLEASE SCROLL TO THE BOTTOM OF THIS DOCUMENT TO START/ENGAGE IN THE
   CURRENT MEETING
       PLEASE SCROLL TO THE BOTTOM OF THIS DOCUMENT TO START/ENGAGE IN THE
   CURRENT MEETING
       PLEASE SCROLL TO THE BOTTOM OF THIS DOCUMENT TO START/ENGAGE IN THE
   CURRENT MEETING
       History can now be found at:
   [3]https://github.com/anima-wg/anima-bootstrap/blob/concise/minutes/ani
   ma-20170502/anima-bootstrap.txt
   2017-04-25:
     *     present: mcr, peter, mbehringer, kent looking for correct
       webex...  Didn't work for me.
     * webex is dead to me:  [4]https://appear.in/anima-boostrap I'm in.
     * Michael Behringer... you joining? trying hard. I'm in the appear in
       room, I THINK. But can't see anyone else?  You mistyped the URL. no
       't' my gosh....
     *
     * {mcr still way behind; was ill last week}
     *

   brief recap by mcr, about what we did last week.
   Max: recap of list is that we need a definitive form for the voucher
   request.... "it's just a voucher" ,
   Kent: related, but slightly different format.
   Max: signed certificate requests mean that the registrar can not change
   it, and this has caused a mess.
   mcr asks for details... max: lack of interoperation.
   To fix the syntax from 1357:

   voucher request
   {
       "header": "foo"
   }
   .
   {
     *     payload" : "bar"

   }
   .signature
   {
       "header": "foo"
   }
   .
   {
     * payload" : "bar",
     * prior_jwt : "{h}.{p,prior_jwt:"<base64>"}.s"

   }
   .signature
   Max's proposed algorithm for signing vouchers is:
     * The relying party validates and signs the "first" voucher in the
       list
     * The relying party MAY recurse into the list to verify, for example,
       that the inner jwt was signed by the pledge

     * Processing is effectively this:
     * recurse to the bottom of the list. Built a json from the payload.
       As you return up the list re-apply each JSON payload.

     * Has the disadvantage of making it difficult to remove something.

     each node copies what it want to maintain. the optional history list
   is purely informative. <----- BEST
     *

   DIAGRAM OF ACTORS:
                                      CMS
       [MASA] <--A--> [ REGISTRAR ] <--C--> [ CERTAUTHORITY ]
               voucher  \
               proto      \B  [BRSKI/EST]
                            \
                              [PLEDGE]
   handling criticality:
       [5]https://tools.ietf.org/html/rfc7515#section-4.1.11
        {"alg":"ES256",
         "crit":["exp"],
         "exp":1363284000
        }
   [6]https://tools.ietf.org/html/rfc7951 (yang-json)
   [7]https://datatracker.ietf.org/doc/draft-ietf-core-yang-cbor/ (yang to
   cbor)
   [8]https://tools.ietf.org/html/rfc7950#section-11 (updating a yang
   module)
      o  A "mandatory" statement may be removed or changed from "true" to
         "false".

   ACTION:
     * 1) add version field to the voucher
     * 2) define voucher request in BRSKI (as a voucher)
     * 3) define any additional fields in BRSKI:

     *


   module ietf-voucher-req {
     import ietf-vouher {
       prefix v;
     }

     augment "v:voucher/" {
         leaf prior_signedvoucher {
             type binary;
             description
                "...";
         }
   }
     *

   2017-05-02
     * present: mcr, Michael Behringer
     *
     * suggest we go through EDNOTEs in document.
     *
     *    [[EDNOTE: move below?]]The Pledge establishes a TLS connection
       with
     *     ---> agreed
     * [9]https://github.com/anima-wg/anima-bootstrap/blob/concise/dtboots
       trap-anima-keyinfra.txt
     *
     * Is there a relationship between the TLS Server Certificate of the
       MASA, and the Issuer Certificate from the IDevID.
     * Cases:
     *  - pledge contains URL of MASA
     *  - step 1: registrar follows URL (default)
     *  - option 1: redirect: should it be allowed? (if not, cannot deploy
       anti-DDOS re-direct)
     *  - option 2: manual override of URL: should it be allowed?
     * Tentatively: Neither option 1 or 2 have an impact on security
       ("stealing" a device).
     * HTTP/2, TLS upgrade.
     * Can/should the registrar connect to MASA, online to the TLS
       connection to the Pledge, to get the certificate chain to validate
       the pledge?
     * {is there an attack on the Registrar by the pledge,
     * MB suggests that[DEL: IDevID and :DEL] MASA Server Certificate
       would be verifiable via the WebPKI, and there would not necessarily
       be any common root of trust between the two.
     *
     * There are two security associations:
     * - between pledge and MASA
     * - between Registrar and MASA
     * Observations:
     * - those two SAs are independent
     * - the first (BRSKI/EST) is anchored on a trust anchor that may be
       private (ie not part of the public PKI)
     * - the second (MASA<->Registrar) is normally anchored on the public
       WebPKI for the ServerCertificate.
     * - the URL in the certificate of the IDevID of the pledge may be
       used to point the registrar to the MASA. (or, redirect, or
       override, see line 1477-1478)
     *   --> In that URL, the vendor defines the type of security
       association to be used between registrar and MASA.
     *   --> The vendor choooses the type of SA. MUST define a minimum
       protocol set that MUST be supported on the registrar, including a
       minimum level of security.
     *

   2017-05-09
     * present: max, Michael Behringer, mcr, kent (looking for the webex
       again)
     * "webex" is at:  [10]https://appear.in/anima-boostrap  (can we
       update the meeting invite with this URL?)  I'll update the WIKI?
     * - I updated the local copy of the meeting invite.  Regardless, it
       says that I'm the only oe in the room...  Click on URL above. on
       line 140. I did.  Works for me. Not alone.  In now.
     *
     * [11]https://trac.ietf.org/trac/anima/wiki/Bootstrap updated.  got
       question for kent!
     *
     * discussion of URL:

     * [12]https://tools.ietf.org/html/draft-ietf-anima-bootstrapping-keyi
       nfra-05#section-2.3


     * 1) URL contains "[13]https://example.com"

     * ACTION: s3.1 would need to indicate that 'https' needs to be
       specified? or deal with http using http2 w/ upgrade? either way
       need to
     * decide what the normative text on that would be

     2) Every protocol defines .well-known/protocol
     * so, "[14]https://example.com/.well-known/protocol"
     * the above might be resolved by .well-known indicating the transport
       method (e.g. http or https)

     3) A protocol


     redirect handled as specified (see 3.1.3.1 in 05, and the EST
   redirect discussion).


     ACTION: Need normative language that the registrar<->MASA
   communication is secured using a "web pki"


   Going to JWT discussion. Discussion of Kent's email from may2:

   I've had some time now to investigate JWS, in particular, reproducing
   some examples in RFCs 7515 and 7520 using nothing but shell scripts and
   the `openssl` command line utility.
   I want to like JWS, but I wish the header was in a more
   technology-neutral format, it being JSON seems weird to me.
   Had this been done, it would be a nice general-purpose signature
   format.  Size wise, JWS grows the size of the data 33% when b64
   encoding it for the "compact serialization" form, which is actually a
   65-character alphabet including '.'.  It seems that a binary header
   could've also allowed for a binary payload and signature, which
   would've been perfect, in my opinion.  [Of course, the entire binary
   blob could still be base64url-encoded for those that want it, without
   forcing it on those that don't]
   The example voucher you obtained from mcr wasn't as trimmed down as it
   could've been, using the -noattr and -nocert options, which is one
   reason the asn1parse dump looks as busy as it does.  Another being that
   the owner/domain-cert-trusted-ca encode very different certs (is one ec
   while the other is rsa?)
   In the end, JWS appears to be just another signature format with its
   own set of peculiarities.  And given that we already have to support
   ASN.1 (the voucher encodes both an X.509 cert as well as a X.509
   certificate chain), not to mention the need for the MASA to have a PKIX
   infrastructure, it's not clear to me if this is a good trade at all.
   Lastly, as mentioned before, my netconf zerotouch draft uses CMS/PKCS7
   elsewhere.  While it would be trivial to update the draft to use a
   JWS-based format, it would be awkward for clients to have to consider
   it at all.
   Kent
     *

   2017-05-16:
       present: mcr, max (joining), peter,
     *  [15]https://appear.in/anima-boostrap
     *
     *
     * [DEL: I am doing a thorough review as the document shepherd with my
       ANIMA :DEL]
     * [DEL: chair hat on. Please address the below comments so that we
       could :DEL]
     * [DEL: process this document further. I cannot claim myself a
       security :DEL]
     * [DEL: expert, so extra security expert review is needed, either in
       WGLC or :DEL]
     * [DEL: IESG review stage. :DEL]
     *
     * Firstly, there is report that this document has warnings or errors
     * returned by YANG validation. [DEL: Please  :DEL]
     *

     * Likely this was the bug in the validator.


     Secondly, please check the references and normative words. This

     document has a "MUST not", which is not an accepted usage according
   to

     RFC 2119. RFC6066 & RFC5652 has been quota in the document, but not

     defined; and normative reference to an Informational RFC 2315.


     * This is fixed in the ietf-voucher.yang.
     * Discussion about whether there should be a failure if the
       expires-on field can not be validated due to lack of clock.


     Thirdly, there are 19 question marks in the document. Most of these

     are discussed and reach conclusions, I believe. Please remove these

     question marks and relevant text. If there are still open questions,

     please discuss in mailing list and address them, before we could

     process WGLC.
     * done.



     In section 2, The quota from Konrad Lorenz should be put into

     quotation marks.
     * done.


     "This document describes vouchers in detail."It is better to give a

     reference to the specific section 4.


     In definition of Domain CA, "Optionally, it certifies all elements."

     What does the term "element" mean? This term does not appear anywhere

     else in the document.
     *




     In definition of MASA, "It does not track ownership." It is not clear

     for me, whether the MASA is technically not be able to track
   ownership

     or in the commercial deployment model, it MUST NOT/SHOULD NOT track

     ownership. There is no enough description or discussion on the

     relationship between the MASA and device ownership.


     A few inconsistent for capital abbreviation, such as cn-id, dns-id,

     etc.


     A few DISCUSS & EDNOTE from editor notes should be removed.
     * done.


     The normative words in design consideration seems odd for me. The

     design consideration means not protocol definition neither behavior

     specification although security consideration may be specification in

     my eyes. It should not have normative words.
     * done.


     Typo: "informative", "informative"; "Circustance", "Circumstances";

     "maintanence", "maintenance"; hardware security modules (HSMs),

     Hardware Security Modules (HSMs).




           leaf expires-on {

             type yang:date-and-time;

             must "not(../nonce)";

             description

               "A value indicating when this voucher expires.  The node is

                optional as not all pledges support expirations, such as

                pledges lacking a reliable clock.


                If this field exists, then the the pledge MUST ensure that

                the expires-on time has not yet passed.  A pledge without

                an accurate clock cannot meet this requirement.


     [insurance. i have to drop. sorry]


     [DEL:            The MASA SHOULD NOT populate this field for pledges
   that :DEL]

     [DEL:            do not have real time clocks."; :DEL]

           }




           <section title="Security Considerations" anchor="sec-con">

             <section title="Clock Sensitivity">

               <t>

                 An attacker could use an expired voucher to gain control
   over

                 a device that has no understand of time.

               </t>

               <t>

                 To defend against this there are three things: devices
   are

                 required to verify that the expires-on field has not yet
   passed.

                 Devices without access to time can use nonces to

                 get ephermal vouchers.

                 Thirdly, vouchers without expiration times may be used,
   which

                 will appear in the audit log, informing the security
   decision.

               </t>


               <t>This document defines optional artifacts containing time
   values

               for voucher expirations, which require an accurate clock

               in order to be processed correctly.  Vendors planning on

               issuing vouchers with expiration values must ensure devices

               have an accurate clock when shipped from manufacturing

               facilities, and take steps to prevent clock tampering.

               If it is not possible to ensure clock accuracy then

               vouchers with expirations should not be issued.</t>

             </section>
   This is my personal webex. We should be able to edit live in the
   etherpad.
   [16]https://cisco.webex.com/join/pritikin
   AGREED TO RESUME Friday, at 11am. MAX, please confirm, or suggest
   another time.
   Thursday at 1pm is another possible time.
   DISCUSS 1
                 <t hangText="Ownership ID Voucher:">An Ownership ID
   Voucher is
                     named after inclusion of the Pledge's CN-ID or DNS-ID
   within the
                     voucher. An example Ownership Voucher is defined in
                     <xref target="I-D.ietf-netconf-zerotouch"/>. The MASA
   service
                     mitigates a MiTM Registrar by identifying the
   specific Registrar
                     authorized to own the Pledge. [DISCUSS: still
   needed?]</t>
     module: ietf-voucher
        +--ro voucher
           +--ro created-on                          yang:date-and-time
           +--ro expires-on?                         yang:date-and-time
           +--ro assertion                           enumeration
           +--ro serial-number                       string
           +--ro serial-number-issuer?               binary
           +--ro pinned-domain-cert*                  binary

           +--ro assert-revocations-on-PKIX-certs?   boolean
           +--ro nonce?                              binary
           +--ro last-renewal-date?                  yang:date-and-time
   Argument for this is: When the 'pinned-domain-cert' is updated by the
   registrar (e.g. they communicate with their CA infrastructure and
   update this) then the registrar is sufficiently online to obtain a new
   voucher.
   There are edge conditions concievable where this not possible but these
   add significant complexity for minimal value and are declared out of
   scope.
   The relying Pledge examines the pinned-domain-cert and uses it as
   follows:
       if it is a CA cert then it is used as a trust-point in a PKI
   heirarchy and any leaf certificates it issues is valid.
       if it is an end-entity cert then only that entity is trusted.

   BRSKI Protocol interaction (-pre06 section 3.3):

      The voucher request is signed by the Registrar as indicated in
      [I-D.ietf-anima-voucher] voucher.  The entire certificate chain, up
      to and including the Domain CA, MUST be included.  The MASA service
      checks the internal consistency of the voucher request but does not
      authenticate the domain identity information since the domain is not
      know to the MASA server in advance.  The MASA server MUST verify
   that
      the voucher request is signed by a Registrar certificate (by
   checking
      for the cmc-idRA field) that was issued by a the self signed root
      certificate included in the request.  This ensures that the
   Registrar
      making the claim is an authorized Registrar of the unauthenticated
      domain.
      The root certificate is extracted and used to populate the Voucher
   [pinned-domain-cert].
      The domain ID (e.g. hash of the public key of the domain) is
      extracted from the root certificate and is used to update the audit
      log. [update to put the whole pinned-domain-cert field in there]

   This assumes that it is the domain's root-CA certificate that is
   pinned. This is an assumption that the pinned CA certificate is
   specific to the owner. This excludes the possibility of a shared root
   CA (as we see in the web PKI space). The assumption is that if there is
   a PKI service it supports multi-tenancy and maintains a unique root per
   domain.
         leaf-list pinned-domain-cert {
           type binary;
           mandatory true;
           description
             "An X.509 v3 certificate structure as specified by RFC 5280,
              Section 4 encoded using the ASN.1 distinguished encoding
              rules (DER), as specified in ITU-T X.690.
              This certificate is used by a pledge to trust a public key
              infrastructure, in order to verify a domain certificate
              supplied to the pledge separately by the bootstrapping
              protocol.  The domain certificate MUST have this certificate
              somewhere in its chain of certificates. This certificate
              MAY be an end-entity certificate, including a self-signed
              entity.
              The voucher's expiration MAY NOT exceed the dates of any of
   the pinned-domain-cert certificates.

           reference
             "RFC 5280:
                Internet X.509 Public Key Infrastructure Certificate
                and Certificate Revocation List (CRL) Profile.
              ITU-T X.690:
                 Information technology - ASN.1 encoding rules:
                 Specification of Basic Encoding Rules (BER),
                 Canonical Encoding Rules (CER) and Distinguished
                 Encoding Rules (DER).";
         }


               The expires-on value MUST NOT exceed the expiration date of
   any of the listed 'pinned-domain-cert' certificates.



   2017-05-23:
       present: mcr, toerles kent, peter, max   (who is "Mria Rita?)
       toerless: we are at:  [17]https://appear.in/anima-boostrap Note no
   t.
        [18]https://github.com/anima-wg/voucher

   Agenda for tuesday:
     * Continue to close the open discuss's for voucer as per sheng's
       email
     * Return to the converation of the voucher request format.

     * [19]https://github.com/anima-wg/voucher/blob/master/draft-ietf-anim
       a-voucher.txt

      [[EDNOTE: It might be worth including an indication of maximum
      lifetime for which such automated renewal is available.  If so the
      language we'd use would be similar to the RFC5280 statement that
      certificate validity period is "the time interval during which the
   CA
      warrants that it will maintain information about the status of the
      certificate" only here used to inform the Registrar of "the time
      interval during which the MASA warrants that it will maintain
      information about the status of the ownership claim".  Such a field
      would be independent of the actual validity period of the voucher
   and
      is not intended for consumption by the Pledge.  A suggested name for
      this field would be "last-renewal-date".]]

           description
             "The date that the MASA projects to be the last date it
              will renew a voucher on.  This field is merely informative,
   it
              is not processed by pledges.

   Circumstances may occur after the voucher's generation          that
   can alter a voucher's validity period.




   For Toerless:
   [20]http://tools.ietf.org/tools/rfcdiff/rfcdiff.pyht?url1=draft-ietf-an
   ima-bootstrapping-keyinfra-05&url2=https://raw.githubusercontent.com/an
   ima-wg/anima-bootstrap/concise/dtbootstrap-anima-keyinfra.txt
     * [21]https://raw.githubusercontent.com/anima-wg/anima-bootstrap/conc
       ise/dtbootstrap-anima-keyinfra.txt

         // DISCUSS: does the transition to 'pinning' model mean we can
         // drop this leaf for now? future proofing allows it to be added
         // if needed but its a edge condition?
         //
         // DISCUSS: there must be such future proofing. not clear where
         // to add it in the voucher document. This is probably the most
         // important point of these discusses
         leaf assert-revocations-on-PKIX-certs {
     * Turned into discussion about whether to fail open/fail closed, and
       how this occurs.
     * Max points out that the MASA is going to verify the revocation
       status (if possible) of the Registrar (owners certificate) when it
       issues the voucher, and since the voucher is short lived (shorter
       than any CRL), then the voucher would expire before the CRL would
       matter anyway, so the Pledge really doesn't need to worry about
       this.
     *
     * The cert that gets pinned into the voucher is probably a sub-CA
       certificate...
     *
     *       leaf domain-cert-revocation-checks {
     *         type boolean;
     *         must "../expires-on";
     *         description
     *           "A processing instruction to the device that it should
     *            verify revocation information for the PKIX certificates
     *            related to the 'pinned-domain-cert' certificate. This is
       available only if
     *            the pledge has an accurate clock. This is in addition
     *            to any revocation checks performed by the MASA.
     *
     *            If this field is not set, then normal PKIX RFC5280
       behaviour applies to validation of the Registrar certificate.";
     *
     *

   Afternoon session: Max, mcr, kent
         leaf serial-number {
           type string;
           mandatory true;
           description
             "FIXME A unique identifier (e.g., serial number) within the
   scope
              of the MASA.
              When processing a vouchers, pledges MUST ensure that their
              unique identifier matches at least one regular expression in
              the list.  If no matching regular expression is found, the
              pledge MUST NOT process this voucher.";
         }
         leaf serial-number-issuer {
           type binary;
           description
             "FIXME  Optional because serial-numbers alone are sometimes
   unique ";
         }

     * MCR: would the MASA keep the same serial-number upon renewal?

   s3.3 of BRSKI [conside] pre06 contains the following text about
   renewal:

      As described in [I-D.ietf-anima-voucher] vouchers are normally short
      lived to avoid revocation issues.  If the request is for a previous
      (expired) voucher using the same Registrar (as determined by
      Registrar's' domainID) and the MASA has not been informed that the
      claim is invalid - the request for a renewed voucher SHOULD be
      automatically authorized.  If authorization is successful the MASA
      responds with a [I-D.ietf-anima-voucher] voucher.  The MASA SHOULD
      check for revocation of the Registrar certificate.  The maximum
      lifetime of the voucher issued SHOULD NOT exceed the lifetime of the
      Registrar's revocation validation (for example if the Registrar
      revocation status is indicated in a CRL that is valid for two weeks
      then that is an appropriate lifetime for the voucher).
   NOTES:
       7.2 refs revocation. verify text
       6.1 has a "must" that MUST be resolved ;)



       leaf serial-number {
           type string;
           mandatory true;
           description
             "A serial number of the hardware.  It is unique within the
   scope of the MASA.
              When processing a voucher, a pledge MUST ensure that its
              serial number matches this value.  If no match occurs, then
              the pledge MUST NOT process this voucher.";
         }
         leaf idevid-issuer {
           type binary;
           description
             "The RFC5280 4.2.1.1 Authority Key Identifier OCTET STRING
   from the IDevID
             that contains the serial number.  Optional since some
   serial-numbers are
             already unique within the scope of the MASA.  Inclusion of
   the statisticaly unique key
             identier ensures statistically unique identification of the
   hardware.

             When processing a voucher, a pledge MUST ensure that its
   IDevID Authority
             Key Identifier matches this value.  If no match occurs, then
   the pledge
             MUST NOT process this voucher.

             When issuing a voucher, the MASA MUST ensure that this field
   is populated
             for serial numbers that are not otherwise unique within the
   scope of the MASA.";
         }

   BRSKI concern:
     * the registrar extracts serial number from the idevid and forwards
       to MASA
     * there is no "multitenant" mechanism here; other than to include the
       serial-number-issuer
     * thus one needs a distinct MASA URL each. so no re-use of the URL?
     *
     * s2.2 would need a normative statement that the URL is unique per
       issuer
     *
     *
     * search for "unique-id":
     *
       [22]https://tools.ietf.org/html/draft-ietf-netconf-zerotouch-13#sec
       tion-10.3  (leaf defined)
     *
       [23]https://tools.ietf.org/html/draft-ietf-netconf-zerotouch-13#sec
       tion-10.2  (passed as a URL query param here)
     *
     * [24]https://gist.github.com/mcr/4b0c52863c364e4645d4f2de16d40e75
     *

   ------------------------------
   2017-05-30: max, Michael Behringer, Toerless Eckert
   [25]https://appear.in/anima-boostrap
   (actually, that isn't loading. moving off my vpn)
   I'm going here:
   [26]https://cisco.webex.com/join/pritikin
   i don't see toerless joining yet
   [27]https://tools.ietf.org/tools/rfcdiff/rfcdiff.pyht
   TODO:
   3.1.1 Discovery: Check if "ACP+Proxy" is the correct GRASP defintion.
   This is a note for Toerless. We will table until we see his suggested
   diff. Concern is that Brian indicates something in his draft and we
   want alignment. Toerless will check.
   --------------------------------
   Q1: Is there any statement that the MASA can be optional, eg: is it
   clear what would
       need to be implemented on pledge and registrar for pledges that do
   not require a MASA ?

   " A Registrar MAY be configured to
      ignore the history of the device but it is RECOMMENDED that this
   only
      be configured if hardware assisted NEA [RFC5209] is supported."
   and
   4.2.  New Entity security reductions
   "   The Pledge MAY have an operational mode where it skips Voucher
      validation one time.  For example if a physical button is depressed
      during the bootstrapping operation.  This can be useful if the
   vendor
      service is unavailable.  This behavior SHOULD be available via local
      configuration or physical presence methods to ensure new entities
   can
      always be deployed even when autonomic methods fail.  This allows
   for
      unsecured imprint.
      It is RECOMMENDED that this only be available if hardware assisted
      NEA [RFC5209] is supported."
   Q2: Is there any statement how a device without an IDevID could be
   used, pledge/registrar ?
   4.3.  Registrar security reductions
      2.  A registrar MAY choose to accept devices that claim a unique
          identity without the benefit of authenticating that claimed
          identity.  This could occur when the Pledge does not include an
          X.509 IDevID factory installed credential.  New Entities without
          an X.509 IDevID credential MAY form the Section 3.2 request
   using
          the Section 3.3 format to ensure the Pledge's serial number
          information is provided to the Registar (this includes the
          IDevIDAuthorityKeyIdentifier value which would be statically
          configured on the Pledge).  The Pledge MAY refuse to provide a
          TLS client certificate (as one is not available).  The Pledge
          SHOULD support HTTP-based or certificate-less TLS authentication
          as described in EST RFC7030 section 3.3.2.  A Registrar MUST NOT
          accept unauthenticated New Entities unless it has been
   configured
          to do so by an administrator that has verified that only
   expected
          new entities can communicate with a Registrar (presumably via a
          physically secured perimeter).
   Q3: Is there a list of assignments needed ?
       Page 13: id-mod-MASAURLExtn2016 - who assigns this ?
   5.  IANA Considerations
   5.1.  PKIX Registry
      This document requests a number for id-mod-MASAURLExtn2016(TBD) from
      the pkix(7) id-mod(0) Registry.  [[EDNOTE: fix names]]
      This document requests a number from the id-pe registry for id-pe-
      masa-url.  XXX
   --------------------------------
   Note 1: text is in textual order, sometimes i went back and found
   additional issues,
   so the point numbering (Nxxx) is not in numerical order.
   Note 2: I gave up on typos quickly, thats a separate round.
   =======================================================================
   =============================
   --------------------------------
   N1: The intro with "BRSKI provides a foundation to securely answer" is
   great if we would
   want the document to target only a room full of security expert. For
   the rest of us (ANIMA = OPS)
   i think it would be great to prepend a few sentences that answer
   questions like "what planet are we
   on, what context do i need to load int my brain to understand the
   following".
   I have suggested text to do that preprended before the existing text.
   COMMENT: section 3.8 attempts to draw a clear line between BRSKI and
   EST to ensure a reasonable pivot to non-PKI solutions as necessary.
   Future proofed.
   --------------------------------
   A change has been added to clarify why voucher's are their own
   document.
   OK.
   ---------------------------------
   N2: "storing an X.509 root certificate".
   Does this need to be a "root" certificate ?
   Consider the most likely simple enterprise or SP deployment of BRSKI.
   Organization has some root-CA. for the purpose of a particular ANI, a
   sub-CA is created, which
   becomes the assigning CA that the registrar uses. The root-CA itself is
   likely never online
   except when both Data Centers with the asigning CAs burn down.
   In these environments, it is not suffficient to only store on the
   pledge the root-CA, because
   that root-CA will also assign other subCA that create certificates, and
   those certificates
   would not be valid for our ANI.
   So, the pledge could either just store the assigning-CA, which becomes
   a virtual root CA,
   and if it burns down the ANI is frozen (no new pledges possible,
   re-enroll whole ANI with
   new CA), or the pledges need to store the CA-chain with root-CA and
   assigning CA. WHich is the
   best solution because it allows revocation/renewal of assigning CA in
   desaster cases.
   I did not modify any text, but i am worried about this problem for
   actual deployments so i would
   like to make sure we have documented an actual working solution.
   Agreed: Remove the word "root".
   TBD: Move example of root CA and assigning CA into voucher document
   The current text of the voucher document is (description of the
   relevant field in the yang module):
         leaf-list pinned-domain-cert {
           type binary;
           min-elements 1;
           description
             "An X.509 v3 certificate structure as specified by RFC 5280,
              Section 4 encoded using the ASN.1 distinguished encoding
              rules (DER), as specified in ITU-T X.690.
              This certificate is used by a pledge to trust a public key
              infrastructure, in order to verify a domain certificate.
   In BRSKI terms: "in order to verify that the registrar is a member of
   the domain by verifying it has a certificate that can be verified using
   pinned-domain-cert".
              supplied to the pledge separately by the bootstrapping
              protocol.  The domain certificate MUST have this certificate
              somewhere in its chain of certificates.  This certificate
              MAY be an end-entity certificate, including a self-signed
              entity.";
           reference
             "RFC 5280:
                Internet X.509 Public Key Infrastructure Certificate
                and Certificate Revocation List (CRL) Profile.
              ITU-T X.690:
                 Information technology - ASN.1 encoding rules:
                 Specification of Basic Encoding Rules (BER),
                 Canonical Encoding Rules (CER) and Distinguished
                 Encoding Rules (DER).";
         }


         leaf domain-cert-revocation-checks {
           type boolean;
           must "../expires-on";
           description
             "A processing instruction to the pledge that it MUST verify
              the revocation status for the domain certificate.  This
              instruction is only available for vouchers that expire. If
              this field is not set, then normal PKIX behaviour applies
              to validation of the domain certificate.";
         }

         leaf voucher-revocation-check {
             // something to force (e.g. MUST) verify the revocation
             // status for the voucher's certificate chain, to the
             // extent possible
         }


     *           KENT: What does it say in your version of voucher about
       lifetime? Section 6.1 4th paragraph?   just a sec

     * Or can you push your version?  (i can't, i'm mid-edit right now...)

               OK, pkease just check for us and i'll wait till your edit
   is done.


     6.1.  Renewals instead of Revocations

     The EDNOTE needs to be removed.  (done, in my local copy)


   In BRSKI -06 it indicates:
   "The maximum
      lifetime of the voucher issued SHOULD NOT exceed the lifetime of the
      Registrar's revocation validation (for example if the Registrar
      revocation status is indicated in a CRL that is valid for two weeks
      then that is an appropriate lifetime for the voucher)."
   I think this is ok. The voucher document doesn't include this because
   it is a MASA behavior discussion.
   --------------------------------
   N3: The intro says "and local access control lists. The Pledge
   actions"...
   What "and local access control lists" does this talk about ? If nobody
   knows, maybe delete ?
   Suggest: (eg: whitelist or blacklist on registrar).
     *
     * -      lists. The Pledge actions derive from a cryptographically
       protected
     * +      lists (administratively defined white or black lists). The
       Pledge actions derive from a cryptographically protected
     *

   --------------------------------
   N4: I think the "Other Bootstrapping Approaches" is also a level of
   brackground information that
   hurts the "ease of digestion" flow for the reader, so i have moved it
   into an appendix and left
   a breadcrump in the intro section. Otherwise unchanged.
   Not clear if we want to accept this change at all. MCR made it less
   destructive by moving it to the last appendix in Toerless's suggested
   XML.
   Here the git best practices of individual commits (via pull requests)
   would be helpful.
   --------------------------------
   N5: "In many target applications, the systems involved are ".... this
   section
   in secion 1.3 is i think quite crucial and one of the biggest benefits
   of BRSKI
   and a great reasoning why we have new complex elements like proxy and
   MASA, but i
   think it is more suggestive than descriptive and raises more questions
   than
   it answers. And even tthat is already divesting the readers attention
   by being
   in the beginning of the document. This topic IMHO deserves a more
   thorough explanation.
   I have suggested an appendix section "Flexible SKU management" that
   tries to do this.
   I think it is appropriate for an appendix, because it seems that to
   enable this functionality,
   we would need some more functionality eg: across ACP, in MASA and so
   on.
   TODO: Change text to indicate the overall property is an ANIMA feature
   where both BRSKI and ACP need to collaborate to improbe ove existing
   bootstraps.
   --------------------------------
   N6: The "Scope of the solution" section is really a discussion about
   the applicability to
   constrained environments. This IMHO also is not necessary to be at the
   top, so i also moved
   it into an appendix and left a breadcrump in the introduction. Also
   changed the name
   to "Applicability to constrained environments" as this is more
   descriptive of the actual content.

   [28]https://tools.ietf.org/tools/rfcdiff/rfcdiff.pyht?url1=draft-ietf-a
   nima-bootstrapping-keyinfra-06&url2=https://raw.githubusercontent.com/a
   nima-wg/anima-bootstrap/toerless_review_20170530/dtbootstrap-anima-keyi
   nfra.txt

   N6.1: "The bootstrapping process can take minutes to complete". I
   bulletized and extended
   the reasons for this. If i missed any core reasons contributing to the
   problem, please add.
             <t>The bootstrapping process can take minutes to complete
   depending on
           the network infrastructure and device processing speed.  Some
   of the reasons for this include: </t>
         <t><list style="symbols">
              <t>The network communication itself is not optimized for
   speed (eg: no optimization for the number of round-trips).</t>
              <t>For privacy reasons, the discovery process allows for the
   Pledge to
                 avoid announcing it's presence through broadcasting. This
   can delay
                 bootstrap by the periodicity interval of the GRASP
   M_FLOOD announcements
                 (eg: 30 seconds).</t>
                <t>Cryptographic operations (such as key generation and
              exponentiation) can take a minute or more on pledges because
   of low-end CPU or TPM chips.</t>
              </list>
           </t>
   N6.2: "This protocol is not intended for low latency handoffs". I find
   the idea of
   thinking to use this protocol for that purpose as grotesque as
   requesting a new passport
   every time i want to go through airport security (instead of using one
   i got in before).
   Aka: to me the statement is more confusing than helpfull. I would
   recommend to remove the sentence
   or provide a more founded explanation why anybody would think about
   this option.
   N6.3: "specifically there are protocol aspects described here which
   might result
   in congestion collapse"...  The following text makes it sound as if the
   verbosity of the
   per-pledge enrolment is main the reason. I think this is misleading.
   From my understanding,
   the likely even more important reason is the fact that parallel
   enrollment of multiple pledges
   can not well be serialized. At least thats exactly the issue the 6TSCH
   adaptation of BRSKI is trying
   to fix by reverting the initiator/responder roles. I have tried to
   improve the text accordingly. Please check.
   N6.4: "It could also be used by non-constrained devices across a
   non-energy constrained, but challenged network"
   An short explanation what constitute being challenged in respect to
   802.15.4 would help. Otherwise it is unclear why that example is being
   mentioned.
   -        <t>BRSKI provides a foundation to securely answer the
   following
   +
   +        <t>The primary use-case for BRSKI is to be the secure,
   zero-touch
   +        bootstrap component of an Autonomic Networking Infrastructure
   (ANI) as defined in
   +        <xref target="RFC7575" /> and refined in <xref
   target="I-D.ietf-anima-reference-model" />.
   +        The normative part of this document is necessary and
   sufficient for a
   +        minimum interoperability standard to achieve this for
   equipment in well
   +        managed, non-constrained networks and non-constrained class 2+
   devices
   +        (as per <xref target="RFC7228" />).</t>
   +
   +        <t>Limitations and possible modifications/extensions to BRSKI
   are discussed
   +        later in the document. For example refer to <xref target="IoT"
   /> for how BRSKI relates
   +        to IoT environments and to <xref target="reducedsecuritymodes"
   /> for how to adopt BRSKI
   +        to various degress of reduced security.</t>
   +
   +        <t>BRSKI is most easily understood as a new layer around PKI
   certificate
   +        enrollment using Enrollment over Secure Transport (EST, <xref
   target="RFC7030" />) to make it</t>
   +            <t><list style="symbols">
   +               <t>fully zero-touch and reliably diagnosed</t>
   +               <t>eliminate trust on first use via  the introduction
   of protocol between a

     * eliminate 'Trust  on First Use' (TOFU) [RFC7435], 'resurrecting
       duckling' [Stajano99theresurrecting] or 'pre-staging' via the
       introduction of this BRSKI protocol between a

   +                  MASA (Manufacturer Authorized Signing Authority) and
   (owner) Registrar</t>
   +               <t>support minimal connectivity for initial bootstrap
   while protecting core network resources
   +                  by the introduction of a component called the
   (Circuit) Proxy.</t>
   +               </list>
   +            </t>
   +
   +        <t>This new layer of BRSKI provides a foundation to securely
   answer the following
   --------------------------------
   N7: The paragraph mentioning 802.1X is very suggestive and IMHO opens
   more questions
   than answering them. It also breaks the core flow of the text. I
   suggest to move this
   discussion into an appendix and make it more descriptive. I have
   proposed text for this
   via a separate appendix (Network Access Control interop).
   for section 1.1:
           <t>BRSKI does not depend upon, or preclude <xref
   target="NACinterop">Network Access Control.</xref></t>
   --------------------------------
   N8: "Architectural Overview"
   N8.1: "Each component is logical and may be combined with other
   components as necessary."
   I have no idea what this means. It sounds like i can build a solution
   without Registrar
   and without Pledge. Aka: either clarify or remove sentence.
     * combined->colocated

   N8.2: Figure 1: Suggested improvements to picture leveraged in below
   improved explanation.
   Added protocol to lines to clarify which protocols run where.
         In order to deploy an LDevID to the pledge, the Registrar also
   acts as a
         PKI Registration Authority.</t>
   IMprove picture:
         - PKI RA included in Domain Registrar box
         - dotted line through the circuit proxy (to clarify it is just a
   proxy)
         - Label edges with appropriate protocols (need to come up with
   different word instead of BRSKI for new protocol elements -> Max:).
         EST        - unchanged EST PKI RA to CA
         BRSKI-EST    - these are EST as exists plus section 3.8
         BRSKI-MASA   - these are the communications to the MASA from the
   vendor

         - Ownership Tracker in Vendor Service dotted (optional).

     * eg: remove from toerless pictuer - optional extension (no, PKI RA
       madatory in registrar).

   N8.3: Suggested improved text for textual explanation of Figure 1.
   - It needed to better explain each block shown and how they relate. Eg;
   Added text for MASA.
   - Original text said that PKI RA can optionally be integrated with
   Domain Registrar.
     In reality i think that it is the other way around: It MUST be
   integrated with Domain
     Registrar unless additional extensions are implemented, eg: in
   Circuit Proxy. Explained that
     in the text.
   - Mentioned that PKI CA can be outsourced and does not require any
   BRSKI extensions.
     important IMHO to show the simplicity of deployment.


                                              +------------------------+
      +--------------Drop Ship--------------->| Vendor Service         |
      |                                       +------------------------+
      |                                       | M anufacturer|         .
      |                                       | A uthorized  |Ownership|
      |                                       | S igning     |Tracker  .
      |                                       | A uthority   |         |
      |                                       +--------------+-.-.-.-.-+
      |                                                      ^
      |                                            3.3,3.4   |  BRSKI-
      V                                            3.6,3.7   |   MASA
   +-------+     ............................................|...
   |       |     .                                           |  .
   |       |     .  +------------+ 3.2   +-----------+       |  .
   |       |     .  |            | 3.4   |           |       |  .
   |Pledge |     .  |   Circuit  | 3.5   | Domain    <-------+  .
   |       |     .  |   Proxy    | BRSKI | Registrar |          .
   |       <-------->............<-------> (PKI RA)  |          .
   |       |     .  |            | B-EST |           |          .
   |       |     .  +------------+ 3.8   +-----+-----+          .
   |IDevID |     .                             | EST RFC7030    .
   |       |     .           +-----------------+----------+     .
   |       |     .           | Key Infrastructure         |     .
   |       |     ............| (e.g. PKI Certificate      |......
   +-------+     .           |       Authority)           |     .
                 .           +----------------------------+     .
                 .                                              .
                 ................................................
                               "Domain" components


   --------------------------------
   N9: 2.3 Protocol flow
   N9.1: Expanded picture
     - showing GRASP for Registrar discovery by Circuit Proxy, ACP, L2 to
   circuit proxy
   N9.2 - redid discovery part.
   +--------+         +---------+    +------------+     +------------+
   | Pledge |         | Circuit |    | Domain     |     | Vendor     |
   |        |         | Proxy   |    | Registrar  |     | Service    |
   |        |         |         |    |  (PKI RA)  |     |  (MASA)    |
   +--------+         +---------+    +------------+     +------------+
     Discovery of Registrar by Proxy:
     |                     |<------------------|                    |
     |                     |  GRASP M_FLOOD    |                    |
     |                     |                   |                    |
       Discovery of Proxy by Pledge:
     |<-RFC4862 IPv6 adr   |                   |                    |
   or|<-RFC3927 IPv4 adr   | Appendix A/E      |                    |
     |                     |                   |                    |
     |-------------------->|                   |                    |
     | optional: mDNS query| Appendix E        |                    |
     | RFC6763/RFC6762     |                   |                    |
     |<--------------------|                   |                    |
     | GRASP M_FLOOD       |                   |                    |
     |   periodic broadcast|                   |                    |
     |                     |                   |                    |

     TLS connection Proxy to Proxy:
     |<------------------->C<----------------->|                    |
     |              TLS via the Circuit Proxy  |                    |
     |<--Registrar TLS server authentication---|                    |
   [PROVISIONAL accept of server cert]         |                    |
     P---X.509 client authentication---------->|                    |
     P                     |                   |                    |
     P---Request Voucher (include nonce)------>|                    |
     P                     |                   |                    |
     P                     |       /--->       |                    |
     P                     |       |      [accept device?]          |
     P                     |       |      [contact Vendor]          |
     P                     |       |           |--Pledge ID-------->|
     P                     |       |           |--Domain ID-------->|
     P                     |       |           |--optional:nonce--->|
     P                     |       |           |     [extract DomainID]
     P                     |       |           |                    |
     P                     |    optional:      |     [update audit log]
     P                     |       |can        |                    |
     P                     |       |occur      |                    |
     P                     |       |in         |                    |
     P                     |       |advance    |                    |
     P                     |       |           |                    |
     P                     |       |           |<-device audit log--|
     P                     |       |           |<- voucher ---------|
     P                     |       \---->      |                    |
     P                     |                   |                    |
     P                     |       [verify audit log and voucher]   |
     P                     |                   |                    |
     P<------voucher---------------------------|                    |
   [verify voucher ]       |                   |                    |
   [verify provisional cert|                   |                    |
     |                     |                   |                    |
     |<--------------------------------------->|                    |
     | Continue with RFC7030 enrollment        |                    |
     | using now bidirectionally authenticated |                    |
     | TLS session.        |                   |                    |
     |                     |                   |                    |
     |                     |                   |                    |
     |                     |                   |                    |
   --------------------------------
   at end of 2017-06-02:
   [29]https://tools.ietf.org/tools/rfcdiff/rfcdiff.pyht?url1=draft-ietf-a
   nima-bootstrapping-keyinfra-06&url2=https://raw.githubusercontent.com/a
   nima-wg/anima-bootstrap/toerless_review_20170530/dtbootstrap-anima-keyi
   nfra.txt
   at the end of 2017-06-06:
   [30]https://tools.ietf.org/tools/rfcdiff/rfcdiff.pyht?url1=https://raw.
   githubusercontent.com/anima-wg/anima-bootstrap/toerless_review_20170530
   /dtbootstrap-anima-keyinfra.txt&url2=https://raw.githubusercontent.com/
   anima-wg/anima-bootstrap/toerless_review_section3_20160606/dtbootstrap-
   anima-keyinfra.txt
   [31]https://tools.ietf.org/tools/rfcdiff/rfcdiff.pyht?url1=draft-ietf-a
   nima-bootstrapping-keyinfra-06&url2=https://raw.githubusercontent.com/a
   nima-wg/anima-bootstrap/toerless_review_section3_20160606/dtbootstrap-a
   nima-keyinfra.txt
   N10: Protocol details
   N10.1: Moved "run BRSKI when unconfigured" into subsection "High Level"
   and amended that
   with an explanation of the high level workflow.
   N10.2: Added explanation why BRSKI is EST7030 extension (instead of
   separate connection)
   also ecause of circuit proxy.
   N10.2: "If the Registrar responds with a redirection to other web
   origins the Pledge MUST follow
               only a single redirection"
   Can we detail a single workflow where this is beneficial in the
   standard workflow, eg:
   wrt to the Circuit Proxy ? I fail to see how this would work in general
   except if the
   Pledge has aquired a global IPv4/IPv6 address.
   N10.3: "discovered Registar" -> "discovered Circuit Proxies"
   --------------------------------
   N11: "IPv4/mDNS operations"
   It is unclear from existing text when and why pledges and/or proxies
   would want to use
   IPv4 instead of IPv6 and/or mDNS instead of GRASP. Without further
   changes, these sections
   would easily result in a lot of incompatible implementation choices.
   I have proposed an expanded, refined text under the title of
   "Supporting pledges without ANI".
   That IMHO is really the context for which all these options are
   relevant:
    - which devices could this apply to (many)
    - benefits of BRSKI for these devices with simple example
    - explain how to do BRSKI discovery using whatever protocols pledge
   already uses without BRSKI
      (IPv4 vs. IPv6, mDNS vs GRASP)
    -
   I suggest to move this whole text into a new standalone document. Even
   if it becomes a rather
   sort document, it would IMHO help a lot to promote the idea of applying
   BRSKI outside of full ANI
   implementations.
   If we fork off a document for this right now, we can leave a breadcrump
   (reference) to it
   in BRSKI itself and therefore make sure that readers of BRSKI will
   still know about that
   large scope of applicability of BRSKI.
   Note: This move would of course eradicate all mentioning of IPv4 and
   mDNS from the main BRSKI
   document.
   NX.1: I have added a sentence "Circuit Proxy SHOULD send unsolicited
   multicast responses for
         the bootstrap service every 30 seconds" to the section about how
   to operate mDNS.
   My understanding of RFC6762 is that there is NO periodic unsolicited
   multicast of
   responses, so what this sentence says is a change to RFC6762. If that
   change is acceptable
   to IESG review, then pledges can passively listen to mDNS. If this
   sentence is not acceptable,
   then the whole paragraph will become questionable and pledges using
   mDNS may be forced to
   send queries to reliably get responses.
   --------------------------------
   TODO: Need to update author addresses. (Also for Steinthor - just
   pinged him)
   Toerless: Webex loading slowly...(toerless) 39% now..
   Whats a good URL to compare two RFC XML files, then i can bring that up
   and screen share once my webex is up
   2017-06-02:
     *     present: mcr,
     * webex or appear.in?

   May Kuato live!!
   6/6: kent - are we meeting today? where?
     * we are doing appear.in right now?
     * (I have a webex standing by if we need it ;)

   2017-06-06:
     *     present: mcr, toerless, max, michaelbehringer, kent (still
       here, just listening...)
     *
     *

   3.  Protocol Details
   [DEL:    The Pledge MUST initiate BRSKI after boot if it is
   unconfigured.  The :DEL]
   [DEL:    Pledge MUST NOT automatically initiate BRSKI if it has been
   :DEL]
   [DEL:    configured or is in the process of being configured. :DEL]
      BRSKI is described as extensions to EST [RFC7030] to reduce the
      number of TLS connections and crypto operations required on the
      Pledge.  The Registrar implements the BRSKI REST interface within
   the
      same .well-known URI tree as the existing EST URIs as described in
      EST [RFC7030] section 3.2.2.  A MASA URI is therefore "https://
      authority "./well-known/est".
      Establishment of the TLS connection for bootstrapping is as
   specified
      in EST [RFC7030] section 4.1.1 "Bootstrap Distribution of CA
      Certificates" [RFC7030] with the following extensions for
   automation:
      Automation extensions for the Pledge (equivalent to EST client) are:
      o  The Pledge provisionally accepts the Registrar certificate during
         the TLS handshake as detailed in EST.
      o  If the Registrar responds with a redirection to other web origins
         the Pledge MUST follow only a single redirection.  (EST supports
         redirection but does not allow redirections to other web origins
         without user input).
      o  The Registar MAY respond with an HTTP 202 ("the request has been
         accepted for processing, but the processing has not been
         completed") as described in EST [RFC7030] section 4.2.3 wherein
         the client "MUST wait at least the specified 'retry-after' time
         before repeating the same request".  The Pledge is RECOMMENDED to
         provide local feed (blinked LED etc) during this wait cycle if
         mechanisms for this are available.  To prevent an attacker
         Registrar from significantly delaying bootstrapping the Pledge
         MUST limit the 'retry-after' time to 60 seconds.  To avoid
   waiting
         on a single erroneous Registrar the Pledge MUST drop the
         connection after 5 seconds and proceed to other discovered
         Registrars.  Ideally the Pledge could keep track of the
         appropriate retry-after value for any number of outstanding
         Registrars but this would involve a large state table on the
         Pledge.  Instead the Pledge MAY ignore the exact retry-after
   value
         in favor of a single hard coded value that takes effect between
         discovery (Appendix D.1.1.1) attempts.  A Registrar that is
   unable
         to complete the transaction the first time due to timing reasons
         will have future chances.
      o  The Pledge requests and validates a voucher using the new REST
         calls described below.
      o  If necessary the Pledge calls the EST defined /cacerts method to
         obtain the current CA certificate.  These are validated using the
         Voucher.
      o  The Pledge completes authentication of the server certificate as
         detailed in Section 3.4.1.  This moves the TLS connection out of
         the provisional state.  Optionally the TLS connection can now be
         used for EST enrollment.
      The Pledge establishes the TLS connection with the Registrar through
      the circuit proxy (see Appendix D.1.2) but the TLS connection is
   with
      the Registar; so in the above section the "Pledge" is the TLS client
      and the "Registrar" is the TLS server.  All security associations
      established are between the new device and the Registrar regardless
      of proxy operations.
      The extensions for a Registrar (equivalent to EST server) are:
      o  Client authentication is automated using Initial Device Identity.
         The subject field's DN encoding MUST include the "serialNumber"
         attribute with the device's unique serial number.  In the
   language
         of RFC6125 this provides for a SERIALNUM-ID category of
   identifier
         that can be included in a certificate and therefore that can also
         be used for matching purposes.  The SERIALNUM-ID whitelist is
         collated according to vendor trust anchor since serial numbers
   are
         not globally unique.
      o  The Registrar requests and validates the Voucher from the vendor
         authorized MASA service.
      o  The Registrar forwards the Voucher to the Pledge when requested.
      o  The Registar performs log verifications in addition to local
         authorization checks before accepting optional Pledge device
         enrollment requests.
   3.1.  Discovery
      The result of discovery is a logical communication with a Registrar,
      through a Proxy.  The Proxy is transparent to the Pledge but is
      always assumed to exist.
      To discover the Registrar the Pledge performs the following actions:
      [DEL: a.  MUST: Obtains a local address using IPv6 methods as
   described in :DEL]
   [DEL:        [RFC4862] IPv6 Stateless Address AutoConfiguration.
   [RFC7217] is :DEL]
   [DEL:        encouraged.  Pledges will generally prefer use of IPv6
   Link-Local :DEL]
   [DEL:        addresses, and discovery of Proxy will be by Link-Local
   :DEL]
   [DEL:        mechanisms.  [[EDNOTE: In some environments, a routable
   public :DEL]
   [DEL:        address may be obtained, should it be?  Should it be
   used?]] IPv4 :DEL]
   [DEL:        methods are described in Appendix A :DEL]
     [DEL: b.  MUST: Listen for GRASP M_FLOOD ([I-D.ietf-anima-grasp])
   :DEL]
   [DEL:        announcements of the objective: "ACP+Proxy".  See section
   :DEL]
   [DEL:        Section 3.1.1 for the details of the the objective.  The
   Pledge :DEL]
   [DEL:        may listen concurrently for other sources of information,
   see :DEL]
   [DEL:        Appendix B. :DEL]
   [DEL:    Once a proxy is discovered the Pledge communicates with a
   Registrar :DEL]
   [DEL:    through the proxy using the bootstrapping protocol defined in
   :DEL]
   [DEL:    Section 3. :DEL]
    [DEL:   Each discovery method attempted SHOULD exponentially back-off
   :DEL]
   [DEL:    attempts (to a maximum of one hour) to avoid overloading the
   network :DEL]
   [DEL:    infrastructure with discovery.  The back-off timer for each
   method :DEL]
   [DEL:    MUST be independent of other methods. :DEL]
      [DEL: Methods SHOULD be run in parallel to avoid head of queue
   problems :DEL]
   [DEL:    wherein an attacker running a fake proxy or registrar can
   operate :DEL]
   [DEL:    protocol actions intentionally slowly. :DEL]
   [DEL:    Once a connection to a Registrar is established (e.g.
   establishment :DEL]
   [DEL:    of a TLS session key) there are expectations of more timely
   :DEL]
   [DEL:    responses, see Section 3.2. :DEL]
   [DEL:    Once all discovered services are attempted the device SHOULD
   return :DEL]
   [DEL:    to listening for GRASP M_FLOOD.  It should periodically retry
   the :DEL]
   [DEL:    vendor specific mechanisms.  The Pledge MAY prioritize
   selection :DEL]
   [DEL:    order as appropriate for the anticipated environment. :DEL]
   3.1.1.  Proxy Discovery Protocol Details
      The proxy uses the GRASP M_FLOOD mechanism to announce itself.  This
      announcement is done with the same message as the ACP announcement
      detailed in [I-D.ietf-anima-autonomic-control-plane].
       proxy-objective = ["Proxy", [ O_IPv6_LOCATOR, ipv6-address,
       transport-proto, port-number ] ]
       ipv6-address       - the v6 LL of the proxy
       transport-proto    - 6, for TCP 17 for UDP
       port-number        - the TCP or UDP port number to find the proxy
      Figure 5
   [DEL: 3.1.2.  Registrar Discovery Protocol Details :DEL]
   [DEL:    A Registrar is typically configured manually.  When the
   Registrar :DEL]
   [DEL:    joins an Autonomic Control Plane :DEL]
   [DEL:    ([I-D.ietf-anima-autonomic-control-plane]) it MUST respond to
   GRASP :DEL]
   [DEL:    ([I-D.ietf-anima-grasp]) M_NEG_SYN message. :DEL]
   [DEL:    The registrar responds to discovery messages from the proxy
   (or GRASP :DEL]
   [DEL:    caches between them) as follows: (XXX changed from
   M_DISCOVERY) :DEL]
   [DEL:     objective         = ["AN_registrar", F_DISC, 255 ] :DEL]
   [DEL:     discovery-message = [M_NEG_SYN, session-id, initiator,
   objective] :DEL]
   [DEL:    Figure 6: Registrar Discovery :DEL]
   [DEL:    The response from the registrar (or cache) will be a
   M_RESPONSE with :DEL]
   [DEL:    the following parameters: :DEL]
   2017-06-13:
     *     present: mcr, max, toerless, peter van der stok, kent
     * GO AHEAD WITHOUT MCR. Time for a reboot anyway after 100 days up.

   we are going to meet here
   [32]https://cisco.webex.com/join/pritikin
   I like the concept of 'appear.in' but the inconsistency of it is
   annoying
     * [DEL: max, can you let me in on my desktop now? :DEL]

   For voucher last call discussion make the following changes:

       * voucher's are an assertion of 'binding' between a 'pledge' an an
   'owner'. This assertion is signed by the entity making the assertion
   which MAY be either a Pledge, a Registrar or a MASA (based on who the
   intended recipient of the voucher is). The relying party makes a policy
   decision about accepting the assertion.  [toerless has additional edits
   he wishes]
   2017-06-16
     * present: max, kent, toerless (*)

   Good morning folks. I'm in the [33]https://appear.in/anima-boostrap
   location but will have my webex standing by if needed.
   agenda:
     * first discuss voucher pull request:
     * [34]https://github.com/anima-wg/voucher/pull/4

     * [35]https://github.com/anima-wg/voucher/pull/4/commits/dec09a4acf96
       b0cfca5f7063bcdfe9b4043b4d80
     *

     Summary:



     discuss associated changes in BRSKI (max to share)

     move to toerless's ongoing diffs


   2017-06-20:
       present: mcr, toerless, kent (joining)
     *

   [apparently no notes for 06-20?]

     *

   2017-06-27:
       present: mcr, kent, max (coming in), toerless, peter
   Need to post the final voucher doc to address last call comments.
     * Max to inform last call thread of these changes to ensure BRSKI can
       go to last call w/o further changes to voucher.
     * Kent to push voucher update.

   Some prepatory notes / agenda proposals:
     * From "important dates"
     * 2017-07-03 (Monday): Internet Draft submission cut-off (for all
       drafts, including -00) by UTC 23:59, upload using IETF ID
       Submission Tool.


     * handle pull request:
       [36]https://github.com/anima-wg/anima-bootstrap/pull/7
     *
     * Open issues:

     * [37]https://github.com/anima-wg/anima-bootstrap/issues
     *

     ietf99 agenda:
     * Wednesday, July 19, 2017 (only?)
     * What is our plan. Did we get space to discuss etc.
     *

   ACTION: max to write up description of proposed voucher and BRSKI
   changes to WGLC thread.
     * - discussion about proximity
     *

   [38]https://github.com/anima-wg/anima-bootstrap/issues/4
   2017-06-29:
     *     present: max,
     *

   2017-07-25:
       present: kent, mcr, max, toerless,

       BRSKI will import the YANG voucher model, and will refine it to
   produce a voucherrequest.
       Discussion about whether or not YANG 1.1 deprecated/discouraged use
   of refine.
       No, this was "deviation", not refine. [see
   [39]https://tools.ietf.org/html/draft-ietf-netmod-rfc6087bis-13]
       ACTION: Kent to produce some suggested text for the 'voucher
   request' so we can evaluate
       Voucher request dsicussion is targeted for BRSKI document. If it is
   unweildy/complex beyond reason then we would make the voucher doc
   address. But generally: our goal is to allow voucher document to
   proceed (not hold it up!) and get BRSKI
       finalized asap afterward. This may not be globally ideal but it is
   a local ideal.

       [DEL: TOPIC from MCR: freshness in nonce and PoP in voucherrequest.
   :DEL]
     *     concern that nonce in voucher request may be "stale" --- that
       it could be captured and then repeated.

     *   proximity tries to assert that the registry and pledge are near
       each other.

          We believe that the VR being signed by the same identity as the
   TLS Client Certificate.

     * The MASA verifies that the Registrar making the claim is the same
       registrar that the pledge sees. This ensures that the asokan etc
       attack is not occuring. It is not a freshness check.
     * What is verified is: The pledge and the MASA are seeing the same
       registrar.
     * ACTION: mcr to write up concern for security considerations, and to
       explain why the above solves the problem.
     * "   pinned-domain-cert:  In a Pledge voucher request this is the
     *       Registrar certificate as extracted from the TLS handshake
       (for
     *       example the first certificate in the TLS 'certificate_list'
     *       sequence (see [RFC5246]).  This MUST be populated in a
       Pledge's
     *       voucher request if the "proximity" assertion is populated."

       TOPIC from Max: lets discuss 'proxy' and Lp (as per thread)
     *
       [40]https://www.ietf.org/mail-archive/web/anima/current/msg02857.ht
       ml
     *
       [41]https://www.ietf.org/mail-archive/web/anima/current/msg02862.ht
       ml
     *     ACTION: mcr to write up the Proxy tells the Registrar what the
       LxX is
     *               vs:  the Registrar tells the Proxy what LxR to use
     *               vs:  the Registrar has multiple addresses and all
       tunnels are unique.
     *

   2017-08-01:
       present: mcr, max, kent
     *     additional discussion for proxy discussion:

     * As indicated in Discover 3.1 the Pledge:

      a.  MUST: Obtains a local address using IPv6 methods as described in
          [RFC4862] IPv6 Stateless Address AutoConfiguration.  [RFC7217]
   is
          encouraged.  Pledges will generally prefer use of IPv6
   Link-Local
          addresses, and discovery of Proxy will be by Link-Local
          mechanisms.  IPv4 methods are described in Appendix A

          Add text ref RFC4941 temporary addresses (s3.3):

                       Use of <xref target="RFC4941" /> temporary
   addresses is
                       encouraged.  A new temporary address SHOULD be
   allocated
                       whenever the discovery process is forced to restart
   due
                       to failures.

     * Content-Type: application/voucher[request]; format=jwt  <- not well
       defined.
     *
     * Content-Type: application/voucher[request]+cms
     *

   We agree do the iana for the media types currently defined in the
   document:
   application/voucherrequest
   application/unsignedvoucherrequest
   etc
   With the additional iana for the "+cms" and "+jwt" to be defined IN THE
   FUTURE as well (its just iana cookie cutter for now). These types are
   not used for mandatory to implement but doing the iana work now to
   prepare for future in one shot.
   "Future voucher documents MAY use other +xxx formats, relying parties
   are encouraged to fail gracefully for unknown formats."
   ACTION: Max to produce the diffs for this
   Update address for:
   For "Bjarnason, Steinthor" <sbjarnason@arbor.net>
   sbjarnason@arbor.net
   module ietf-voucher-request {
     yang-version 1.1;
     namespace
       "urn:ietf:params:xml:ns:yang:ietf-voucher-request";
     prefix "vch";
     import ietf-yang-types {
       prefix yang;
       reference "RFC 6991: Common YANG Data Types";
     }
     import ietf-restconf {
       prefix rc;
       description
         "This import statement is only present to access
          the yang-data extension defined in RFC 8040.";
       reference "RFC 8040: RESTCONF Protocol";
     }
     import ietf-voucher {
       prefix v;
       description
         "";
       reference "";
     }
     organization
      "IETF ANIMA Working Group";
     contact
      "WG Web:   <[42]http://tools.ietf.org/wg/anima/>
       WG List:  <[43]mailto:anima@ietf.org>
       Author:   Kent Watsen
                 <[44]mailto:kwatsen@juniper.net>
       Author:   Max Pritikin
                 <[45]mailto:pritikin@cisco.com>
       Author:   Michael Richardson
                 <[46]mailto:mcr+ietf@sandelman.ca>
       Author:   Toerless Eckert
                 <[47]mailto:tte+ietf@cs.fau.de>";
     description
      "This module... FIXME
       The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL', 'SHALL NOT',
       'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'MAY', and 'OPTIONAL' in
       the module text are to be interpreted as described in RFC 2119.
       Copyright (c) 2017 IETF Trust and the persons identified as
       authors of the code. All rights reserved.
       Redistribution and use in source and binary forms, with or without
       modification, is permitted pursuant to, and subject to the license
       terms contained in, the Simplified BSD License set forth in Section
       4.c of the IETF Trust's Legal Provisions Relating to IETF Documents
       ([48]http://trustee.ietf.org/license-info).
       This version of this YANG module is part of RFC XXXX; see the RFC
       itself for full legal notices.";
     revision "YYYY-MM-DD" {
       description
        "Initial version";
       reference
        "RFC XXXX: Voucher Profile for Bootstrapping Protocols";
     }
     //rc:yang-data voucher-request-artifact {
     container voucher-request-artifact {
       // YANG data template for a voucher-request.
       uses v:voucher-artifact-grouping {
         augment "voucher"  {
           leaf prior-signed-voucher2 {
             type binary;
           }
         }
         refine "voucher/created-on" {
           mandatory false;
         }
       }
     }
   }
   A current example from the draft, modified to be a request would look
   like:
      {
        "ietf-voucher-request:voucher": {
          "nonce": "62a2e7693d82fcda2624de58fb6722e5",
   [DEL:        "created-on": "2017-01-01T00:00:00.000Z", :DEL]
          "assertion": "proximity",
          "pinned-domain-cert2": "<base64 encoded certificate>"
        }
      }



   Kent: to create a high level section (between 2 and 3) that details
   this. We'll review the new outline/toc and ensure we like it.
   2017-08-08:
       present: mcr, max, kent


   max to respond to ipr discussion
   max to describe initial mime-type changes
     *
     * [49]https://github.com/anima-wg/anima-bootstrap/commit/2e6d4669d89e
       75a06bcb7dc4cf281543eb24cb66
     * [50]https://www.iana.org/assignments/media-type-sub-parameters/medi
       a-type-sub-parameters.xhtml

   smime-type Value Reference certs-only[RFC5751, Section
   3.2.2]CMC-Request[RFC5273, Section 3]CMC-Response[RFC5273, Section
   3]compressed-data[RFC5751, Section 3.2.2]enveloped-data[RFC5751,
   Section 3.2.2]enveloped-x400[RFC3854, Section
   3.3.1]server-generated-key[RFC7030, Section 4.4.2]signed-data[RFC5751,
   Section 3.2.2]signed-receipt[RFC2634, Section 2.4]signed-x400[RFC3854,
   Section 3.2.1]
      HTTP/1.1 200 OK
      Status: 200 OK
      Content-Type: application/pkcs7-mime; smime-type=voucher
   OPEN QUESTION: do what do we say about the 'content-transfer-encoding'?
      Content-Transfer-Encoding: base64
   For application/json the transfer encoding is text
   raw from my notes:
   smime-type is originally defined in RFC3851 but the more recent
   reference is RFC5751, RFC7030, 3851 etc. But RFC7114 defines the IANA
   registry.
   For raw JSON info, e.g. status we use:
         <section title="Voucher Status Telemetry ">
   [snip]
           <t>The posted data media type: application/json</t>
   We could then do application/json for the unsigned voucher request and
   it would be consistent with this.
   RESOLUTION: use application/json ; max to update text to reflect this
   {
     "ietf-voucher-request:voucher": {
       "nonce": "62a2e7693d82fcda2624de58fb6722e5",
       "created-on": "2017-01-01T00:00:00.000Z",
       "assertion": "proximity"
       "idevid-issuer": "<base64 encoded Authority Key Identifier>"
       "serial-number": "JADA123456789"
       "prior-signed-voucher": "<base64 encode prior voucher request>"
     }
   }
   application/jwt
   [51]https://tools.ietf.org/html/rfc7519
   kent failed to do his action items  :(
       mcr also is behind on actions.

       [52]https://github.com/anima-wg/anima-bootstrap/issues/18

   [53]JavaScript license information

References

   1. https://trac.tools.ietf.org/wg/anima/trac/wiki/Bootstrap
   2. https://tools.ietf.org/html/draft-ietf-anima-bootstrapping-keyinfra-04
   3. https://github.com/anima-wg/anima-bootstrap/blob/concise/minutes/anima-20170502/anima-bootstrap.txt
   4. https://appear.in/anima-boostrap
   5. https://tools.ietf.org/html/rfc7515#section-4.1.11
   6. https://tools.ietf.org/html/rfc7951
   7. https://datatracker.ietf.org/doc/draft-ietf-core-yang-cbor/
   8. https://tools.ietf.org/html/rfc7950#section-11
   9. https://github.com/anima-wg/anima-bootstrap/blob/concise/dtbootstrap-anima-keyinfra.txt
  10. https://appear.in/anima-boostrap
  11. https://trac.ietf.org/trac/anima/wiki/Bootstrap
  12. https://tools.ietf.org/html/draft-ietf-anima-bootstrapping-keyinfra-05#section-2.3
  13. https://example.com/
  14. https://example.com/.well-known/protocol
  15. https://appear.in/anima-boostrap
  16. https://cisco.webex.com/join/pritikin
  17. https://appear.in/anima-boostrap
  18. https://github.com/anima-wg/voucher
  19. https://github.com/anima-wg/voucher/blob/master/draft-ietf-anima-voucher.txt
  20. http://tools.ietf.org/tools/rfcdiff/rfcdiff.pyht?url1=draft-ietf-anima-bootstrapping-keyinfra-05&url2=https://raw.githubusercontent.com/anima-wg/anima-bootstrap/concise/dtbootstrap-anima-keyinfra.txt
  21. https://raw.githubusercontent.com/anima-wg/anima-bootstrap/concise/dtbootstrap-anima-keyinfra.txt
  22. https://tools.ietf.org/html/draft-ietf-netconf-zerotouch-13#section-10.3
  23. https://tools.ietf.org/html/draft-ietf-netconf-zerotouch-13#section-10.2
  24. https://gist.github.com/mcr/4b0c52863c364e4645d4f2de16d40e75
  25. https://appear.in/anima-boostrap
  26. https://cisco.webex.com/join/pritikin
  27. https://tools.ietf.org/tools/rfcdiff/rfcdiff.pyht
  28. https://tools.ietf.org/tools/rfcdiff/rfcdiff.pyht?url1=draft-ietf-anima-bootstrapping-keyinfra-06&url2=https://raw.githubusercontent.com/anima-wg/anima-bootstrap/toerless_review_20170530/dtbootstrap-anima-keyinfra.txt
  29. https://tools.ietf.org/tools/rfcdiff/rfcdiff.pyht?url1=draft-ietf-anima-bootstrapping-keyinfra-06&url2=https://raw.githubusercontent.com/anima-wg/anima-bootstrap/toerless_review_20170530/dtbootstrap-anima-keyinfra.txt
  30. https://tools.ietf.org/tools/rfcdiff/rfcdiff.pyht?url1=https://raw.githubusercontent.com/anima-wg/anima-bootstrap/toerless_review_20170530/dtbootstrap-anima-keyinfra.txt&url2=https://raw.githubusercontent.com/anima-wg/anima-bootstrap/toerless_review_section3_20160606/dtbootstrap-anima-keyinfra.txt
  31. https://tools.ietf.org/tools/rfcdiff/rfcdiff.pyht?url1=draft-ietf-anima-bootstrapping-keyinfra-06&url2=https://raw.githubusercontent.com/anima-wg/anima-bootstrap/toerless_review_section3_20160606/dtbootstrap-anima-keyinfra.txt
  32. https://cisco.webex.com/join/pritikin
  33. https://appear.in/anima-boostrap
  34. https://github.com/anima-wg/voucher/pull/4
  35. https://github.com/anima-wg/voucher/pull/4/commits/dec09a4acf96b0cfca5f7063bcdfe9b4043b4d80
  36. https://github.com/anima-wg/anima-bootstrap/pull/7
  37. https://github.com/anima-wg/anima-bootstrap/issues
  38. https://github.com/anima-wg/anima-bootstrap/issues/4
  39. https://tools.ietf.org/html/draft-ietf-netmod-rfc6087bis-13
  40. https://www.ietf.org/mail-archive/web/anima/current/msg02857.html
  41. https://www.ietf.org/mail-archive/web/anima/current/msg02862.html
  42. http://tools.ietf.org/wg/anima/
  43. mailto:anima@ietf.org
  44. mailto:kwatsen@juniper.net
  45. mailto:pritikin@cisco.com
  46. mailto:mcr+ietf@sandelman.ca
  47. mailto:tte+ietf@cs.fau.de
  48. http://trustee.ietf.org/license-info)
  49. https://github.com/anima-wg/anima-bootstrap/commit/2e6d4669d89e75a06bcb7dc4cf281543eb24cb66
  50. https://www.iana.org/assignments/media-type-sub-parameters/media-type-sub-parameters.xhtml
  51. https://tools.ietf.org/html/rfc7519
  52. https://github.com/anima-wg/anima-bootstrap/issues/18
  53. file:///javascript
